# Інструкція користувача

## 1. Підготовка середовища

1. Переконайтесь, що на комп’ютері встановлені Python 3.10+ та потрібні бібліотеки:
   ```bash
   pip install python-docx docxcompose openpyxl
   ```
2. Підготуйте шаблонний файл Word (за замовчуванням `medals.docx`). У ньому мають бути плейсхолдери:
   - повний рядок «ПАВЛОВУ Денису Сергійовичу»;
   - окремі поля «ПАВЛОВУ», «Денису», «Сергійовичу» (для підстановки прізвища, імені, по батькові).
3. Заповніть `listm.xlsx` (або іншу Excel-таблицю):
   - перший стовпець, починаючи з першого рядка, містить повні ПІБ у називному відмінку;
   - при потребі використайте інший аркуш (вказується в аргументі `--sheet`).

## 2. Використання графічного інтерфейсу

1. Запустіть `run_medals_gui.bat` (можна створити ярлик на робочому столі).
2. У вікні:
   - виберіть шаблон DOCX і файл Excel;
   - за потреби змініть назву аркуша, вихідний файл, каталог для окремих документів;
   - відкоригуйте плейсхолдери (повні й розділені на прізвище/ім’я/по батькові);
   - оберіть режим роботи: «Окремі файли» або «Єдиний файл».
3. Натисніть «Запустити» й дочекайтесь повідомлення «Готово». Якщо з’явилось попередження, прочитайте текст помилки та виправте вхідні дані.

## 3. Запуск із командного рядка

```bash
python make_medals.py \
    --template medals.docx \
    --excel listm.xlsx \
    --separate        # або --single
```

- `--single` збере всі сторінки в один DOCX (без створення каталогу `out/`).
- `--placeholder`, `--placeholder-surname`, `--placeholder-name`, `--placeholder-patronymic` дозволяють змінити текст заміни без редагування коду.
- У режимі `--separate` готові файли з’являться в каталозі `out/`. У `--single` результат записується в `medals_out.docx`.

## 4. Створення чистих копій сторінок

Якщо потрібно лише продублювати сторінки шаблону без текстових замін:

```bash
python duplicate_pages.py --template medals.docx --excel listm.xlsx
```

Скрипт прочитає кількість рядків Excel і створить відповідну кількість сторінок у `medals.docx`.

## 5. Перевірка результатів

1. Після генерації відкрийте готові DOCX у Word/LibreOffice та переконайтесь, що всі прізвища, імена та по батькові правильно відмінені.
2. Якщо знаходите помилки (наприклад, нестандартні прізвища), відредагуйте їх вручну або допишіть логіку до `make_medals.py`.

## 6. Типові проблеми та рішення

- **Відсутній `python-docx` або `openpyxl`.**  
  Перевстановіть бібліотеки через `pip install python-docx docxcompose openpyxl`.
- **Excel не містить даних.**  
  Перевірте, що хоча б один рядок у першому стовпці не порожній.
- **Не замінився текст у шаблоні.**  
  Додайте відповідні `--placeholder*` або змініть плейсхолдери в GUI на фактичні рядки з документа.
